.. _Lwm2mFirmwareUpdateTask:

=======================
Lwm2mFirmwareUpdateTask
=======================

.. figure:: images/Lwm2mFirmwareUpgradeTask.*
  :align: center

  *Fig. Lwm2mFirmwareUpdateTask*

It executes the firmware download procedure.

+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property name                  | XML attribute               | Type    | Description                                                                                                                                                                                                                                                |
+================================+=============================+=========+============================================================================================================================================================================================================================================================+
| Resource                       | resourceId                  | string  | A firmware image file.                                                                                                                                                                                                                                     |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Delivery method                | transferMethod              | string  | :guilabel:`Push` - use CoAP blockwise transfer, :guilabel:`Pull` - use URI for download.                                                                                                                                                                   |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Transfer protocol              | protocol                    | string  | A protocol to conduct a client pull.                                                                                                                                                                                                                       |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Base URL                       | baseUrl                     | string  | Protocol, host and port. If it is not set, then it will be determined on the basis of an download protocol and SVs                                                                                                                                         |
|                                |                             |         | (preferredPublicURLBase/preferredPublicURLBaseHTTP/preferredPublicURLBaseFTP). If SV is not available, then a default value from Coiote DM                                                                                                                 |
|                                |                             |         | configuration will be used.                                                                                                                                                                                                                                |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Use quota                      | useQuota                    | boolean | Use quota to restrict resources available for the task.                                                                                                                                                                                                    |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Blocking                       | blocking                    | boolean | If it is set to *true*, then other tasks will not be executed until this task ends.                                                                                                                                                                        |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Upgrade timeout                | timeoutInSec                | integer | Timeout is seconds.                                                                                                                                                                                                                                        |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Ignore faults                  | ignoreFaults                | boolean | Determines whether task execution will be terminated if any firmware update failure occurs (it will if set to 'false').                                                                                                                                    |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Result variable                | resultVar                   | string  | Identifier of variable under which firmware update result will be stored (ERROR or SUCCESS). This variable can be referenced later in task processing.                                                                                                     |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Result details variable        | resultDetailsVar            | string  | Identifier of variable under which firmware update result details will be stored. This variable can be referenced later in task processing.                                                                                                                |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Use cached data model          | useCacheForInitialStateRead | boolean | Cached data model data is used for initial read to decide whether FOTA state machine restart is needed. If the cached data model is empty, standard data model is checked as a fallback.                                                                   |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Resume after downlink failure  | resumeAfterDownlinkFailure  | boolean | Firmware upgrade resumes execution upon new contact with the device if it stopped during the last communication due to a downlink failure. The place it stopped before is used as a starting point, so it begins by retrying the last unsuccessful action. |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Check transfer/delivery method | checkDeliveryAndProtocol    | boolean | Determines if transfer/delivery method check during the Firmware Upgrade by the FOTA task is performed or not.                                                                                                                                             |
+--------------------------------+-----------------------------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
