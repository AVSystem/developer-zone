
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
  
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/favicon/favicon-32x32.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-6.2.6">
    
  <meta content="https://iotdevzone.avsystem.com/docs/img/AVSystem-social.png" property="og:image" />

    
      
        <title>Exercise 5 - Implement Firmware Update - IoT Developer Zone</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="./assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="./assets/favicon/site.webmanifest">
    <link rel="mask-icon" href="./assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <!-- end favicon -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1572272-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-1572272-2');
    </script>

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-25246208-6","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exercise-5-implement-firmware-update" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <!-- Mitigate bug: https://github.com/mkdocs/mkdocs/issues/2191 -->



<!--

<div class="topLinePageInfo">
        <h5 class="topLinePageInfo__text">
            <a href="https://avsystem.clickmeeting.com/lwm2m/register" class="color-black">
              Join the webinar on Aug 16: <strong>Building end-to-end LwM2M applications</strong> 
                <svg class="ml-1" width="22" height="9" viewBox="0 0 22 9" fill="none"
                     xmlns="http://www.w3.org/2000/svg">
                    <path id="Arrow 1"
                          d="M1 4C0.723858 4 0.5 4.22386 0.5 4.5C0.5 4.77614 0.723858 5 1 5V4ZM21.3536 4.85355C21.5488 4.65829 21.5488 4.34171 21.3536 4.14645L18.1716 0.964466C17.9763 0.769204 17.6597 0.769204 17.4645 0.964466C17.2692 1.15973 17.2692 1.47631 17.4645 1.67157L20.2929 4.5L17.4645 7.32843C17.2692 7.52369 17.2692 7.84027 17.4645 8.03553C17.6597 8.2308 17.9763 8.2308 18.1716 8.03553L21.3536 4.85355ZM1 5H21V4H1V5Z"
                          fill="black"/>
                </svg>
            </a>
        </h5>
    </div>

-->

<!-- Application header -->
<header class="md-header" data-md-component="header" data-md-state="shadow">



  <!-- Top-level navigation -->
  <nav class="md-header-nav md-grid" aria-label="Header">

    <!-- Link to home -->
    <a
      href="https://iotdevzone.avsystem.com/docs/"
      title="IoT Developer Zone"
      class="md-header-nav__button md-logo"
      aria-label="IoT Developer Zone"
    >
      
  <img src="../../assets/images/logo.svg" alt="logo">

    </a>

    <!-- Button to open drawer -->
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>



      <svg class="logoMobile" width="150px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
      viewBox="0 0 221 48">
        <g>
          <path style="fill: #FFD600;" d="M47.5,16.4c-3-7.2-10.1-12.3-18.3-12.3C18.2,4.1,9.3,13,9.3,23.9c0,1.8,0.2,3.5,0.7,5.1h2.2
                  c0.6,0,1.4-0.7,1.6-1.2l3.9-9.8c0.5-1.2,1.7-2.1,3-2.1c1.3,0,2.5,0.8,3,2.1l6.2,15.6c0.3,0.7,1.1,1.2,1.7,1.2h1.3
                  c0.3,0,0.6,0.2,0.8,0.5l0.5,1.4c0.1,0.3,0,0.5-0.3,0.5h-4.2c-1.8,0-3.9-1.5-4.6-3.3L20.7,23c-0.4-1.1-0.8-2.2-1.1-3.3
                  c-0.3,1.1-0.6,2.2-1.1,3.3l-2.1,5.4c-0.7,1.7-2.6,3.1-4.4,3.1h-1.3c3,7.2,10.1,12.3,18.3,12.3c10.9,0,19.8-8.9,19.8-19.8
                  c0-1.8-0.2-3.5-0.7-5.1h-2.2c-0.6,0-1.4,0.7-1.6,1.2l-3.9,9.8c-0.5,1.2-1.7,2.1-3,2.1c-1.3,0-2.5-0.8-3-2.1l-6.2-15.6
                  c-0.3-0.7-1.1-1.2-1.7-1.2h-1.3c-0.3,0-0.6-0.2-0.8-0.5L24,11c-0.1-0.3,0-0.5,0.3-0.5h4.2c1.8,0,3.9,1.5,4.6,3.3l4.4,11.1
                  c0.4,1.1,0.8,2.2,1.1,3.3c0.3-1.1,0.6-2.2,1.1-3.3l2.1-5.4c0.7-1.7,2.6-3.1,4.4-3.1H47.5z"/>
        </g>
      </svg>

    <!-- Header title -->
    <div class="md-header-nav__title" data-md-component="header-title" data-md-state="active">

      <div class="md-header-nav__ellipsis">

        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            IoT Developer Zone
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Exercise 5 - Implement Firmware Update
            
          </span>
        </div>
      </div>
    </div>



    <!-- Button to open search modal -->
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>

      <!-- Search interface -->
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
  </nav>

</header>


    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../LwM2M_Client/Getting_started/" class="md-tabs__link">
        LwM2M Client
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Coiote_IoT_DM/introduction/" class="md-tabs__link">
        Coiote IoT DM
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Demo_Projects/Tracking_tutorial/" class="md-tabs__link">
        Demo Projects
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        LwM2M Academy
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="IoT Developer Zone" class="md-nav__button md-logo" aria-label="IoT Developer Zone">
      
  <img src="../../assets/images/logo.svg" alt="logo">

    </a>
    IoT Developer Zone
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" >
      
      <label class="md-nav__link" for="nav-1">
        Getting Started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="nav-1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="https://discord.avsystem.com/" class="md-nav__link">
        Join Discord Community
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        LwM2M Client
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="LwM2M Client" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          LwM2M Client
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/Getting_started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" >
      
      <label class="md-nav__link" for="nav-2-2">
        Raspberry Pi boards
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Raspberry Pi boards" data-md-level="2">
        <label class="md-nav__title" for="nav-2-2">
          <span class="md-nav__icon md-icon"></span>
          Raspberry Pi boards
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/RaspberryPi/RaspberryPi-Pico-W/" class="md-nav__link">
        Raspberry Pi Pico W
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3" >
      
      <label class="md-nav__link" for="nav-2-3">
        STMicroelectronics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="STMicroelectronics" data-md-level="2">
        <label class="md-nav__title" for="nav-2-3">
          <span class="md-nav__icon md-icon"></span>
          STMicroelectronics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/STMicroelectronics/Building_LwM2M_applications/Building_LwM2M_applications_with_I-CUBE-Anjay/" class="md-nav__link">
        Building LwM2M applications for STM boards with I-CUBE-Anjay
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/STMicroelectronics/STM32L496G-DISCOBG96/" class="md-nav__link">
        STM32L496G-DISCO/BG96
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/STMicroelectronics/B-L462E-CELL1-TYPE1SC/" class="md-nav__link">
        B-L462E-CELL1/TYPE1SC
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/STMicroelectronics/B-L475E-IOT01A/" class="md-nav__link">
        B-L475E-IOT01A
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/STMicroelectronics/B-U585I-IOT02A-BG96/" class="md-nav__link">
        B-U585I-IOT02A/BG96
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/STMicroelectronics/Runtime_certificate/" class="md-nav__link">
        Runtime Certificate and Private Key Configuration
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4" >
      
      <label class="md-nav__link" for="nav-2-4">
        Nordic
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Nordic" data-md-level="2">
        <label class="md-nav__title" for="nav-2-4">
          <span class="md-nav__icon md-icon"></span>
          Nordic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/Nordic/Thingy91/" class="md-nav__link">
        Thingy:91
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/Nordic/nRF9151DK/" class="md-nav__link">
        nRF9151 DK
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/Nordic/nRF9160DK/" class="md-nav__link">
        nRF9160 DK
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/Nordic/nRF7002DK/" class="md-nav__link">
        nRF7002 DK
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/Nordic/Device_Provisioning/" class="md-nav__link">
        Automated Provisioning for Nordic boards
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/Nordic/Runtime_certificate/" class="md-nav__link">
        Runtime Certificate and Private Key Configuration
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5" >
      
      <label class="md-nav__link" for="nav-2-5">
        ESP32
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ESP32" data-md-level="2">
        <label class="md-nav__title" for="nav-2-5">
          <span class="md-nav__icon md-icon"></span>
          ESP32
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/ESP32/M5Stick/" class="md-nav__link">
        M5StickC
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/ESP32/M5StickBG96/" class="md-nav__link">
        M5StickC with BG96
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/ESP32/ESP32-DevKitCBG96/" class="md-nav__link">
        ESP32-DevKitC with BG96
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6" >
      
      <label class="md-nav__link" for="nav-2-6">
        OpenThread
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OpenThread" data-md-level="2">
        <label class="md-nav__title" for="nav-2-6">
          <span class="md-nav__icon md-icon"></span>
          OpenThread
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/OpenThread/Adding_device/" class="md-nav__link">
        Adding nRF board to OpenThread
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../LwM2M_Client/OpenThread/OTBR_with_svetovid/" class="md-nav__link">
        OpenThread Border Router configurable through LwM2M server
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Coiote IoT DM
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Coiote IoT DM" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Coiote IoT DM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" >
      
      <label class="md-nav__link" for="nav-3-2">
        Cloud integration tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cloud integration tutorials" data-md-level="2">
        <label class="md-nav__title" for="nav-3-2">
          <span class="md-nav__icon md-icon"></span>
          Cloud integration tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/cloud-integrations/" class="md-nav__link">
        Cloud integrations overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2-2" type="checkbox" id="nav-3-2-2" >
      
      <label class="md-nav__link" for="nav-3-2-2">
        Data Integration Center
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data Integration Center" data-md-level="3">
        <label class="md-nav__title" for="nav-3-2-2">
          <span class="md-nav__icon md-icon"></span>
          Data Integration Center
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/Device_Integration_Center/influx/" class="md-nav__link">
        InfluxDB
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/Device_Integration_Center/datacake/" class="md-nav__link">
        Datacake
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/Device_Integration_Center/graphql/" class="md-nav__link">
        GraphQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/Device_Integration_Center/slack/" class="md-nav__link">
        Slack
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/Device_Integration_Center/atlas/" class="md-nav__link">
        Atlas
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2-3" type="checkbox" id="nav-3-2-3" >
      
      <label class="md-nav__link" for="nav-3-2-3">
        Azure IoT Hub
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Azure IoT Hub" data-md-level="3">
        <label class="md-nav__title" for="nav-3-2-3">
          <span class="md-nav__icon md-icon"></span>
          Azure IoT Hub
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/Azure_IoT_Hub/Upgrading_firmware/" class="md-nav__link">
        Upgrade device firmware
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/Azure_IoT_Hub/Perform_Read_Write/" class="md-nav__link">
        Perform LwM2M Read and Write
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/Azure_IoT_Hub/Perform_Execute/" class="md-nav__link">
        Perform LwM2M Execute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/Azure_IoT_Hub/Set_an_Observation/" class="md-nav__link">
        Set an Observation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2-4" type="checkbox" id="nav-3-2-4" >
      
      <label class="md-nav__link" for="nav-3-2-4">
        Azure IoT Central
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Azure IoT Central" data-md-level="3">
        <label class="md-nav__title" for="nav-3-2-4">
          <span class="md-nav__icon md-icon"></span>
          Azure IoT Central
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Cloud_integrations/Azure_IoT_Central/Set_an_Observation/" class="md-nav__link">
        Set an Observation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3" >
      
      <label class="md-nav__link" for="nav-3-3">
        Video tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Video tutorials" data-md-level="2">
        <label class="md-nav__title" for="nav-3-3">
          <span class="md-nav__icon md-icon"></span>
          Video tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Coiote_videos/How_to_simply_onboard_and_provision_IoT_devices/" class="md-nav__link">
        How to simply onboard and provision IoT devices?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Coiote_videos/How_to_remotely_configure_IoT_devices/" class="md-nav__link">
        How to remotely configure IoT devices?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Coiote_videos/How_to_perform_secure_Over-the-Air_updates/" class="md-nav__link">
        How to perform secure Over-the-Air (OTA) updates? (nRF9160 DK)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Coiote_videos/How_to_remotely_monitor_IoT_devices_and_diagnose_issues/" class="md-nav__link">
        How to remotely monitor IoT devices and diagnose issues?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Coiote_videos/What_types_of_IoT_data_are_collected_and_stored_in_the_Coiote/" class="md-nav__link">
        What types of IoT data are collected and stored in the Coiote?
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4" >
      
      <label class="md-nav__link" for="nav-3-4">
        API documentation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API documentation" data-md-level="2">
        <label class="md-nav__title" for="nav-3-4">
          <span class="md-nav__icon md-icon"></span>
          API documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-1" type="checkbox" id="nav-3-4-1" >
      
      <label class="md-nav__link" for="nav-3-4-1">
        Overview
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Overview" data-md-level="3">
        <label class="md-nav__title" for="nav-3-4-1">
          <span class="md-nav__icon md-icon"></span>
          Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/API_documentation/Overview/About_Coiote_API/" class="md-nav__link">
        About API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/API_documentation/Overview/Getting_access/" class="md-nav__link">
        Getting access
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/API_documentation/Overview/Using_the_API/" class="md-nav__link">
        Using the API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-2" type="checkbox" id="nav-3-4-2" >
      
      <label class="md-nav__link" for="nav-3-4-2">
        Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Guides" data-md-level="3">
        <label class="md-nav__title" for="nav-3-4-2">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/API_documentation/Guides/Basic_onboarding/" class="md-nav__link">
        How to make basic onboarding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/API_documentation/Guides/Create_a_domain_and_add_users/" class="md-nav__link">
        How to create a domain and add users
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/API_documentation/Guides/Make_firmware_upgrade/" class="md-nav__link">
        How to make firmware upgrade (FOTA)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/API_documentation/Guides/Send_data_outside_application/" class="md-nav__link">
        How to send data outside the application with event handlers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/API_documentation/Guides/Use_device_monitoring/" class="md-nav__link">
        How to use Device monitoring
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/API_documentation/api_reference/" class="md-nav__link">
        API reference
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5" >
      
      <label class="md-nav__link" for="nav-3-5">
        Release Notes
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Release Notes" data-md-level="2">
        <label class="md-nav__title" for="nav-3-5">
          <span class="md-nav__icon md-icon"></span>
          Release Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5-1" type="checkbox" id="nav-3-5-1" >
      
      <label class="md-nav__link" for="nav-3-5-1">
        2025
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="2025" data-md-level="3">
        <label class="md-nav__title" for="nav-3-5-1">
          <span class="md-nav__icon md-icon"></span>
          2025
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.20.0.md" class="md-nav__link">
        None
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.18.0/" class="md-nav__link">
        v2025.18.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.17.0/" class="md-nav__link">
        v2025.17.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.16.0/" class="md-nav__link">
        v2025.16.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.15.0/" class="md-nav__link">
        v2025.15.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.14.0/" class="md-nav__link">
        v2025.14.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.12.0/" class="md-nav__link">
        v2025.12.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.11.0/" class="md-nav__link">
        v2025.11.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.10.0/" class="md-nav__link">
        v2025.10.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.9.0/" class="md-nav__link">
        v2025.9.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.8.0/" class="md-nav__link">
        v2025.8.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.7.0/" class="md-nav__link">
        v2025.7.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.6.0/" class="md-nav__link">
        v2025.6.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.5.0/" class="md-nav__link">
        v2025.5.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.4.0/" class="md-nav__link">
        v2025.4.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.3.0/" class="md-nav__link">
        v2025.3.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.2.0/" class="md-nav__link">
        v2025.2.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2025.1.0/" class="md-nav__link">
        v2025.1.0
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5-2" type="checkbox" id="nav-3-5-2" >
      
      <label class="md-nav__link" for="nav-3-5-2">
        2024
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="2024" data-md-level="3">
        <label class="md-nav__title" for="nav-3-5-2">
          <span class="md-nav__icon md-icon"></span>
          2024
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2024.5.0/" class="md-nav__link">
        v2024.5.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2024.4.0/" class="md-nav__link">
        v2024.4.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2024.3.0/" class="md-nav__link">
        v2024.3.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2024.2.0/" class="md-nav__link">
        v2024.2.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2024.1.0/" class="md-nav__link">
        v2024.1.0
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5-3" type="checkbox" id="nav-3-5-3" >
      
      <label class="md-nav__link" for="nav-3-5-3">
        2023
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="2023" data-md-level="3">
        <label class="md-nav__title" for="nav-3-5-3">
          <span class="md-nav__icon md-icon"></span>
          2023
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.34.0/" class="md-nav__link">
        v2023.34.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.33/" class="md-nav__link">
        v2023.33
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.32/" class="md-nav__link">
        v2023.32
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.31/" class="md-nav__link">
        v2023.31
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.30.0/" class="md-nav__link">
        v2023.30.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.29/" class="md-nav__link">
        v2023.29
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.28/" class="md-nav__link">
        v2023.28
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.27/" class="md-nav__link">
        v2023.27
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.26.1/" class="md-nav__link">
        v2023.26.1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.25.2/" class="md-nav__link">
        v2023.25.2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.24.0/" class="md-nav__link">
        v2023.24.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.22.0/" class="md-nav__link">
        v2023.22.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.19.0/" class="md-nav__link">
        v2023.19.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.17.0/" class="md-nav__link">
        v2023.17.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.16.0/" class="md-nav__link">
        v2023.16.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.15.0/" class="md-nav__link">
        v2023.15.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.14.0/" class="md-nav__link">
        v2023.14.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.12.0/" class="md-nav__link">
        v2023.12.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.11.0/" class="md-nav__link">
        v2023.11.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.10.0/" class="md-nav__link">
        v2023.10.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.9.0/" class="md-nav__link">
        v2023.9.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.7.0/" class="md-nav__link">
        v2023.7.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.6.0/" class="md-nav__link">
        v2023.6.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.5.0/" class="md-nav__link">
        v2023.5.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.4.0/" class="md-nav__link">
        v2023.4.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2023.3.0/" class="md-nav__link">
        v2023.3.0
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5-4" type="checkbox" id="nav-3-5-4" >
      
      <label class="md-nav__link" for="nav-3-5-4">
        2022
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="2022" data-md-level="3">
        <label class="md-nav__title" for="nav-3-5-4">
          <span class="md-nav__icon md-icon"></span>
          2022
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.27.0/" class="md-nav__link">
        v2022.27.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.26.0/" class="md-nav__link">
        v2022.26.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.25.20/" class="md-nav__link">
        v2022.25.20
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.24.14/" class="md-nav__link">
        v2022.24.14
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.23.11/" class="md-nav__link">
        v2022.23.11
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.22.0/" class="md-nav__link">
        v2022.22.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.21.6/" class="md-nav__link">
        v2022.21.6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.20.4/" class="md-nav__link">
        v2022.20.4
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.19.2/" class="md-nav__link">
        v2022.19.2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.18.3/" class="md-nav__link">
        v2022.18.3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.17.0/" class="md-nav__link">
        v2022.17.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.16.0/" class="md-nav__link">
        v2022.16.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.13.5/" class="md-nav__link">
        v2022.13.5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.9.2/" class="md-nav__link">
        v2022.9.2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.8.2/" class="md-nav__link">
        v2022.8.2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.7.3/" class="md-nav__link">
        v2022.7.3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.5.3/" class="md-nav__link">
        v2022.5.3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2022.3.2/" class="md-nav__link">
        v2022.3.2
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5-5" type="checkbox" id="nav-3-5-5" >
      
      <label class="md-nav__link" for="nav-3-5-5">
        2021
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="2021" data-md-level="3">
        <label class="md-nav__title" for="nav-3-5-5">
          <span class="md-nav__icon md-icon"></span>
          2021
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2021.24.5/" class="md-nav__link">
        v2021.24.5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2021.23.0/" class="md-nav__link">
        v2021.23.0
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Coiote_IoT_DM/Release_Notes/v2021.22.1/" class="md-nav__link">
        v2021.22.1
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Demo Projects
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Demo Projects" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Demo Projects
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Demo_Projects/Tracking_tutorial/" class="md-nav__link">
        Asset Tracking using Thingy:91 and Power BI
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="https://www.hackster.io/ferre111/iot-solution-for-co2-measurement-in-the-office-f3b213" class="md-nav__link">
        CO2 office sensor
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Demo_Projects/Edge_Impulse_demo/" class="md-nav__link">
        Motion detection using Edge Impulse and Thingy:91
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Demo_Projects/Implementing_LwM2M_objects_on_RaspberryPi/" class="md-nav__link">
        LwM2M on a Raspberry Pi
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../Demo_Projects/Air_quality_monitoring_tutorial/" class="md-nav__link">
        Air quality monitoring using Azure IoT Hub and Power BI
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
      
      <label class="md-nav__link" for="nav-5">
        LwM2M Academy
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="LwM2M Academy" data-md-level="1">
        <label class="md-nav__title" for="nav-5">
          <span class="md-nav__icon md-icon"></span>
          LwM2M Academy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Welcome
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2" >
      
      <label class="md-nav__link" for="nav-5-2">
        Module 1 - Introduction to LwM2M
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Module 1 - Introduction to LwM2M" data-md-level="2">
        <label class="md-nav__title" for="nav-5-2">
          <span class="md-nav__icon md-icon"></span>
          Module 1 - Introduction to LwM2M
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../module1/" class="md-nav__link">
        Theory Module 1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise1/" class="md-nav__link">
        Exercise 1 - Connect the RPI to a LwM2M Server
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3" >
      
      <label class="md-nav__link" for="nav-5-3">
        Module 2 - Getting started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Module 2 - Getting started" data-md-level="2">
        <label class="md-nav__title" for="nav-5-3">
          <span class="md-nav__icon md-icon"></span>
          Module 2 - Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../module2/" class="md-nav__link">
        Theory Module 2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise2a/" class="md-nav__link">
        Exercise 2A - Analyze Mandatory Objects
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise2b/" class="md-nav__link">
        Exercise 2B - Pre-Shared Key
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4" >
      
      <label class="md-nav__link" for="nav-5-4">
        Module 3 - Building applications
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Module 3 - Building applications" data-md-level="2">
        <label class="md-nav__title" for="nav-5-4">
          <span class="md-nav__icon md-icon"></span>
          Module 3 - Building applications
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../module3/" class="md-nav__link">
        Theory Module 3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise3a/" class="md-nav__link">
        Exercise 3A - Implement Time Object
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise3b/" class="md-nav__link">
        Exercise 3B - Implement Temperature Object
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-5" type="checkbox" id="nav-5-5" >
      
      <label class="md-nav__link" for="nav-5-5">
        Module 4 - Device management
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Module 4 - Device management" data-md-level="2">
        <label class="md-nav__title" for="nav-5-5">
          <span class="md-nav__icon md-icon"></span>
          Module 4 - Device management
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../module4/" class="md-nav__link">
        Theory Module 4
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise4a/" class="md-nav__link">
        Exercise 4A - Read & Observe
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../exercise4b/" class="md-nav__link">
        Exercise 4B - LwM2M Send
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-6" type="checkbox" id="nav-5-6" checked>
      
      <label class="md-nav__link" for="nav-5-6">
        Module 5 - Firmware updates
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Module 5 - Firmware updates" data-md-level="2">
        <label class="md-nav__title" for="nav-5-6">
          <span class="md-nav__icon md-icon"></span>
          Module 5 - Firmware updates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../module5/" class="md-nav__link">
        Theory Module 5
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Exercise 5 - Implement Firmware Update
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Exercise 5 - Implement Firmware Update
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="In this article">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      In this article
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-bootloader-and-why-do-i-need-this-here" class="md-nav__link">
    What is Bootloader and why do I need this here?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-firmware-update" class="md-nav__link">
    Implement Firmware Update
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flash-alignment" class="md-nav__link">
    Flash alignment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recompile-the-application-and-flash-the-board" class="md-nav__link">
    Recompile the application and flash the board
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-the-firmware-update-in-coiote" class="md-nav__link">
    Prepare the Firmware Update in Coiote
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download-upgrade-process" class="md-nav__link">
    Download &amp; Upgrade Process
  </a>
  
    <nav class="md-nav" aria-label="Download &amp; Upgrade Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monitoring-the-update-process" class="md-nav__link">
    Monitoring the update process
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gradproject/" class="md-nav__link">
        Graduation Project
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="In this article">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      In this article
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-bootloader-and-why-do-i-need-this-here" class="md-nav__link">
    What is Bootloader and why do I need this here?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-firmware-update" class="md-nav__link">
    Implement Firmware Update
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flash-alignment" class="md-nav__link">
    Flash alignment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recompile-the-application-and-flash-the-board" class="md-nav__link">
    Recompile the application and flash the board
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-the-firmware-update-in-coiote" class="md-nav__link">
    Prepare the Firmware Update in Coiote
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download-upgrade-process" class="md-nav__link">
    Download &amp; Upgrade Process
  </a>
  
    <nav class="md-nav" aria-label="Download &amp; Upgrade Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monitoring-the-update-process" class="md-nav__link">
    Monitoring the update process
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

<!-- Edit button -->


<!--
  Hack: check whether the content contains a h1 headline. If it
  doesn't, the page title (or respectively site name) is used
  as the main headline.
-->


<!-- Markdown content -->
<h1 id="exercise-5-implement-firmware-update">Exercise 5: Implement Firmware Update<a class="headerlink" href="#exercise-5-implement-firmware-update" title="Permanent link">#</a></h1>
<p>In this exercise, we implement Object 5 - Firmware Update.  It utilizes the <a href="https://github.com/JZimnol/pico_fota_bootloader">pico_fota_bootloader</a> to swap the flash partitions after downloading the appropriate binary file from Coiote IoT DM.</p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">#</a></h2>
<ul>
<li>A Raspberry Pi Pico W board with a USB cable</li>
<li>Installed <strong>minicom</strong> (for Linux), <strong>RealTerm</strong>, <strong>PuTTy</strong> (for Windows), or another serial communication program.</li>
<li>An active <a href="https://eu.iot.avsystem.cloud/">Coiote IoT DM</a> user account</li>
<li>Completed <a href="../exercise4a/">exercise 4A</a> from module 4</li>
<li>Completed <a href="../exercise4b/">exercise 4B</a> from module 4</li>
</ul>
<h2 id="what-is-bootloader-and-why-do-i-need-this-here">What is Bootloader and why do I need this here?<a class="headerlink" href="#what-is-bootloader-and-why-do-i-need-this-here" title="Permanent link">#</a></h2>
<p>A bootloader as a program is responsible for loading and launching the operating system or firmware of a computer or embedded system. It is typically the initial program that runs when a device is powered on or restarted. The bootloader undertakes the essential configuration of internal modules, ensuring that fundamental settings are established for subsequent operations.</p>
<h2 id="implement-firmware-update">Implement Firmware Update<a class="headerlink" href="#implement-firmware-update" title="Permanent link">#</a></h2>
<p>Anjay comes with a built-in Firmware Update module, which simplifies FOTA implementation for the user. Let’s dive into the code and discuss its most important fragments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This part only describes functions that are in the code in <strong>Anjay-pico-client/firmware_update</strong> directory. The user doesn’t have to modify the code.</p>
</div>
<p>In our code, firmware update module installation will be taken by the function declared in <strong>firmware_update.h</strong>:</p>
<p style="text-align: center;">firmware_update.h</p>
<div class="highlight"><pre><span></span><code><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;anjay/anjay.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">fw_update_install</span><span class="p">(</span><span class="n">anjay_t</span><span class="w"> </span><span class="o">*</span><span class="n">anjay</span><span class="p">);</span>
</code></pre></div>
<p>In the main.c file the installation of the Firmware Update module takes place in the <em>anjay_task()</em> funktion:</p>
<p style="text-align: center;">main.c</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">anjay_task</span><span class="p">(</span><span class="n">__unused</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">init_wifi</span><span class="p">();</span>

<span class="w">    </span><span class="n">pfb_firmware_commit</span><span class="p">();</span>

<span class="w">    </span><span class="n">anjay_configuration_t</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">endpoint_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ENDPOINT_NAME</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">in_buffer_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2048</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">out_buffer_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2048</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">msg_cache_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2048</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">g_anjay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">anjay_new</span><span class="p">(</span><span class="o">&amp;</span><span class="n">config</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">avs_log</span><span class="p">(</span><span class="n">main</span><span class="p">,</span><span class="w"> </span><span class="n">ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Could not create Anjay object&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">setup_security_object</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">setup_server_object</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">avs_log</span><span class="p">(</span><span class="n">main</span><span class="p">,</span><span class="w"> </span><span class="n">ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to initialize basic objects&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fw_update_install</span><span class="p">(</span><span class="n">g_anjay</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">avs_log</span><span class="p">(</span><span class="n">main</span><span class="p">,</span><span class="w"> </span><span class="n">ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to initialize FOTA object&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">main_loop</span><span class="p">();</span>

<span class="w">    </span><span class="n">anjay_delete</span><span class="p">(</span><span class="n">g_anjay</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>The Firmware Update module consists of user-implemented callbacks of various sorts implemented in the firmware_update.c file:</p>
<ul>
<li>
<p><code>stream_open</code> is called whenever a new firmware download is started by the server. Its main responsibility is to prepare client for receiving firmware chunks - e.g. by opening a file or getting flash storage ready, etc.</p>
<p><p style="text-align: center;">firmware_update.c</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">fw_stream_open</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">user_ptr</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">package_uri</span><span class="p">,</span>
<span class="w">                          </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">anjay_etag</span><span class="w"> </span><span class="o">*</span><span class="n">package_etag</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">user_ptr</span><span class="p">;</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">package_uri</span><span class="p">;</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">package_etag</span><span class="p">;</span>

<span class="w">    </span><span class="n">pfb_initialize_download_slot</span><span class="p">();</span>
<span class="w">    </span><span class="n">flash_aligned_writer_new</span><span class="p">(</span><span class="n">writer_buf</span><span class="p">,</span><span class="w"> </span><span class="n">AVS_ARRAY_SIZE</span><span class="p">(</span><span class="n">writer_buf</span><span class="p">),</span>
<span class="w">                         </span><span class="n">pfb_write_to_flash_aligned_256_bytes</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">writer</span><span class="p">);</span>

<span class="w">    </span><span class="n">downloaded_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">update_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="n">avs_log</span><span class="p">(</span><span class="n">fw_update</span><span class="p">,</span><span class="w"> </span><span class="n">INFO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Init successful&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p><code>stream_write</code> is called whenever there is a next firmware chunk received, ready to be stored. Its responsibility is to append the chunk to the storage.</p>
<p><p style="text-align: center;">firmware_update.c</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">fw_stream_write</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">user_ptr</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">user_ptr</span><span class="p">;</span>

<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">update_initialized</span><span class="p">);</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flash_aligned_writer_write</span><span class="p">(</span><span class="o">&amp;</span><span class="n">writer</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">downloaded_bytes</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">length</span><span class="p">;</span>
<span class="w">    </span><span class="n">avs_log</span><span class="p">(</span><span class="n">fw_update</span><span class="p">,</span><span class="w"> </span><span class="n">INFO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Downloaded %zu bytes.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">downloaded_bytes</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p><code>stream_finish</code> is called whenever the writing process is finished and the stored data can now be thought of as a complete firmware image. It may be a good moment here to verify if the entire firmware image is valid.</p>
<p><p style="text-align: center;">firmware_update.c</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">fw_stream_finish</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">user_ptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">user_ptr</span><span class="p">;</span>

<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">update_initialized</span><span class="p">);</span>
<span class="w">    </span><span class="n">update_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flash_aligned_writer_flush</span><span class="p">(</span><span class="o">&amp;</span><span class="n">writer</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">avs_log</span><span class="p">(</span><span class="n">fw_update</span><span class="p">,</span><span class="w"> </span><span class="n">ERROR</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;Failed to finish download: flash aligned writer flush failed, &quot;</span>
<span class="w">                </span><span class="s">&quot;result: %d&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">res</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pfb_firmware_sha256_check</span><span class="p">(</span><span class="n">downloaded_bytes</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">avs_log</span><span class="p">(</span><span class="n">fw_update</span><span class="p">,</span><span class="w"> </span><span class="n">ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SHA256 check failed&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p><code>reset</code> is called whenever there is an error during firmware download, or if the Server decides to not pursue firmware update with downloaded firmware (e.g. because it was notified that firmware verification failed).</p>
<p><p style="text-align: center;">firmware_update.c</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">fw_reset</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">user_ptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">user_ptr</span><span class="p">;</span>

<span class="w">    </span><span class="n">update_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">fw_update_reboot</span><span class="p">(</span><span class="n">avs_sched_t</span><span class="w"> </span><span class="o">*</span><span class="n">sched</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">sched</span><span class="p">;</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>

<span class="w">    </span><span class="n">avs_log</span><span class="p">(</span><span class="n">fw_update</span><span class="p">,</span><span class="w"> </span><span class="n">INFO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Rebooting.....&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">pfb_perform_update</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p><code>perform_upgrade</code> is called whenever the download is finished, the firmware is successfully verified on the Client and the Server decides to upgrade the device.</p>
<p><p style="text-align: center;">firmware_update.c</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">fw_perform_upgrade</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">anjay</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pfb_mark_download_slot_as_valid</span><span class="p">();</span>
<span class="w">    </span><span class="n">avs_log</span><span class="p">(</span><span class="n">fw_update</span><span class="p">,</span><span class="w"> </span><span class="n">INFO</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;The firmware will be updated at the next device reset&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">AVS_SCHED_DELAYED</span><span class="p">(</span><span class="n">anjay_get_scheduler</span><span class="p">(</span><span class="n">anjay</span><span class="p">),</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span>
<span class="w">                             </span><span class="n">avs_time_duration_from_scalar</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">AVS_TIME_S</span><span class="p">),</span>
<span class="w">                             </span><span class="n">fw_update_reboot</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></p>
</li>
</ul>
<p>To install the module, we are going to use the <em>fw_update_install()</em> function which is called in the main.c file:</p>
<p style="text-align: center;">firmware_update.c</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">anjay_fw_update_handlers_t</span><span class="w"> </span><span class="n">handlers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">.</span><span class="n">stream_open</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fw_stream_open</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">stream_write</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fw_stream_write</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">stream_finish</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fw_stream_finish</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fw_reset</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">perform_upgrade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fw_perform_upgrade</span>
<span class="p">};</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">fw_update_install</span><span class="p">(</span><span class="n">anjay_t</span><span class="w"> </span><span class="o">*</span><span class="n">anjay</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">anjay_fw_update_initial_state_t</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">};</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pfb_is_after_firmware_update</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ANJAY_FW_UPDATE_INITIAL_SUCCESS</span><span class="p">;</span>
<span class="w">        </span><span class="n">avs_log</span><span class="p">(</span><span class="n">fw_update</span><span class="p">,</span><span class="w"> </span><span class="n">INFO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Running on a new firmware&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pfb_is_after_rollback</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ANJAY_FW_UPDATE_INITIAL_NEUTRAL</span><span class="p">;</span>
<span class="w">        </span><span class="n">avs_log</span><span class="p">(</span><span class="n">fw_update</span><span class="p">,</span><span class="w"> </span><span class="n">WARNING</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Rollback performed&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">anjay_fw_update_install</span><span class="p">(</span><span class="n">anjay</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">handlers</span><span class="p">,</span><span class="w"> </span><span class="n">anjay</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">state</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="flash-alignment">Flash alignment<a class="headerlink" href="#flash-alignment" title="Permanent link">#</a></h2>
<p>Flash APIs require that the length of data to write will be a multiple of 256 bytes, so we need to enforce that by additional buffering. For this in the firmware_update directory there are two more files:</p>
<ul>
<li>
<p>flash_aligned_writer.c</p>
<p><p style="text-align: center;">flash_aligned_writer.c</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;assert.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stddef.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;avsystem/commons/avs_utils.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;flash_aligned_writer.h&quot;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">flash_aligned_writer_new</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">batch_buf</span><span class="p">,</span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">batch_buf_max_len_bytes</span><span class="p">,</span>
<span class="w">                              </span><span class="n">flash_aligned_writer_cb_t</span><span class="w"> </span><span class="o">*</span><span class="n">writer_cb</span><span class="p">,</span>
<span class="w">                              </span><span class="n">flash_aligned_writer_t</span><span class="w"> </span><span class="o">*</span><span class="n">out_writer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">batch_buf</span><span class="p">);</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">batch_buf_max_len_bytes</span><span class="p">);</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">writer_cb</span><span class="p">);</span>

<span class="w">    </span><span class="n">out_writer</span><span class="o">-&gt;</span><span class="n">batch_buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">batch_buf</span><span class="p">;</span>
<span class="w">    </span><span class="n">out_writer</span><span class="o">-&gt;</span><span class="n">batch_buf_max_len_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">batch_buf_max_len_bytes</span><span class="p">;</span>
<span class="w">    </span><span class="n">out_writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">out_writer</span><span class="o">-&gt;</span><span class="n">write_offset_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">out_writer</span><span class="o">-&gt;</span><span class="n">writer_cb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">writer_cb</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">flash_aligned_writer_write</span><span class="p">(</span><span class="n">flash_aligned_writer_t</span><span class="w"> </span><span class="o">*</span><span class="n">writer</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_bytes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">length_bytes</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">bytes_to_copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AVS_MIN</span><span class="p">(</span>
<span class="w">                </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_max_len_bytes</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="p">,</span>
<span class="w">                </span><span class="n">length_bytes</span><span class="p">);</span>
<span class="w">        </span><span class="n">memcpy</span><span class="p">(</span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span>
<span class="w">            </span><span class="n">bytes_to_copy</span><span class="p">);</span>
<span class="w">        </span><span class="n">data</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">bytes_to_copy</span><span class="p">;</span>
<span class="w">        </span><span class="n">length_bytes</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">bytes_to_copy</span><span class="p">;</span>
<span class="w">        </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">bytes_to_copy</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_max_len_bytes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">writer_cb</span><span class="p">(</span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">write_offset_bytes</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">write_offset_bytes</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="p">;</span>
<span class="w">            </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">flash_aligned_writer_flush</span><span class="p">(</span><span class="n">flash_aligned_writer_t</span><span class="w"> </span><span class="o">*</span><span class="n">writer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">writer_cb</span><span class="p">(</span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf</span><span class="p">,</span><span class="w"> </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">write_offset_bytes</span><span class="p">,</span>
<span class="w">                                </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">write_offset_bytes</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="p">;</span>
<span class="w">    </span><span class="n">writer</span><span class="o">-&gt;</span><span class="n">batch_buf_len_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p>flash_aligned_writer.h</p>
<p><p style="text-align: center;">flash_aligned_writer.h</p>
<div class="highlight"><pre><span></span><code><span class="cp">#pragma once</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stddef.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span>

<span class="k">typedef</span><span class="w"> </span><span class="kt">int</span>
<span class="nf">flash_aligned_writer_cb_t</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">offset_bytes</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">len_bytes</span><span class="p">);</span>

<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">batch_buf</span><span class="p">;</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">batch_buf_max_len_bytes</span><span class="p">;</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">batch_buf_len_bytes</span><span class="p">;</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">write_offset_bytes</span><span class="p">;</span>
<span class="w">    </span><span class="n">flash_aligned_writer_cb_t</span><span class="w"> </span><span class="o">*</span><span class="n">writer_cb</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="n">flash_aligned_writer_t</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">flash_aligned_writer_new</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">batch_buf</span><span class="p">,</span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">batch_buf_max_len_bytes</span><span class="p">,</span>
<span class="w">                              </span><span class="n">flash_aligned_writer_cb_t</span><span class="w"> </span><span class="o">*</span><span class="n">writer_cb</span><span class="p">,</span>
<span class="w">                              </span><span class="n">flash_aligned_writer_t</span><span class="w"> </span><span class="o">*</span><span class="n">out_writer</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">flash_aligned_writer_write</span><span class="p">(</span><span class="n">flash_aligned_writer_t</span><span class="w"> </span><span class="o">*</span><span class="n">writer</span><span class="p">,</span>
<span class="w">                               </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">flash_aligned_writer_flush</span><span class="p">(</span><span class="n">flash_aligned_writer_t</span><span class="w"> </span><span class="o">*</span><span class="n">writer</span><span class="p">);</span>
</code></pre></div></p>
</li>
</ul>
<h2 id="recompile-the-application-and-flash-the-board">Recompile the application and flash the board<a class="headerlink" href="#recompile-the-application-and-flash-the-board" title="Permanent link">#</a></h2>
<p>Your data model doesn't have Firmware Update Object <code>/5</code>. For updating this set Raspberry Pi Pico W to the BOOTSEL state (by powering it up with the BOOTSEL button pressed) and copy the <code>build/firmware_update/pico_fota_bootloader/pico_fota_bootloader.uf2</code> file into it. Right now the Raspberry Pi Pico W is flashed with the bootloader but does not have proper application in the application FLASH memory slot yet. Then, set Raspberry Pi Pico W to the BOOTSEL state again and copy the <code>build/firmware_update/firmware_update.uf2</code> file. The board should reboot and start the firmware_update application.</p>
<h2 id="prepare-the-firmware-update-in-coiote">Prepare the Firmware Update in Coiote<a class="headerlink" href="#prepare-the-firmware-update-in-coiote" title="Permanent link">#</a></h2>
<ol>
<li>
<p>In the Coiote IoT Device Management platform, go to <a href="https://eu.iot.avsystem.cloud/ui/device/inventory"><strong>Device Inventory</strong></a>.</p>
</li>
<li>
<p>Go to the <strong>Data model</strong> tab to validate if the Firmware Update Object <code>/5</code> is present. If so, the Object is supported by the LwM2M Client.</p>
<p><img alt="Firmware update object" src="../images/datamodel_fota.JPG" /></p>
</li>
<li>
<p>Go to the <strong>Firmware update</strong> tab.</p>
</li>
<li>
<p>Click the <strong>Update Firmware</strong> button.</p>
<p><img alt="Update Firmware Tab" src="../images/basic-firmware-update-tab.JPG" /></p>
</li>
<li>
<p>Select <strong>Basic Firmware Update</strong>.</p>
<p><img alt="Basic Firmware Update" src="../images/basic-fota.png" /></p>
</li>
<li>
<p>Upload the <strong>firmware image</strong>.</p>
<p><img alt="Upload Firmware Image" src="../images/upload.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The firmware image <code>firmware_update_fota_image_encrypted.bin</code> file can be found in the <code>build/firmware_update</code> directory.</p>
</div>
</li>
<li>
<p>Choose between <strong>Pull</strong> and <strong>Push</strong>:</p>
<ul>
<li>
<p><strong>Pull method</strong> (recommended): The LwM2M Client receives the URI of the file that is to be downloaded and pulls the file from it.</p>
</li>
<li>
<p><strong>Push method</strong>: The LwM2M Server pushes the firmware file to the device.</p>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p><strong>Pull</strong> supports the following <strong>transport types</strong>:</p>
<ul>
<li><code>CoAP</code> or <code>CoAPs</code> over <code>UDP</code></li>
<li><code>CoAP</code> or <code>CoAPs</code> over <code>TCP</code></li>
<li><code>HTTP</code> or <code>HTTPs</code></li>
</ul>
<p><strong>Push</strong> transmits the firmware over the same transport type as is used for device management, which is <code>CoAPs</code> over <code>UDP</code> by default.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Which transport protocol to choose?</p>
<p>Downloads using <code>CoAP(s)</code> over <code>UDP</code> tend to be slow due to the limitation of the maximum CoAP Block size of 1024 bytes and the required acknowledgements for each Block transfer.</p>
<p>Choosing <code>CoAP(s)</code> over <code>TCP</code> or <code>HTTP(s)</code> usually results in faster download speeds. However, not every device supports these transport protocols.</p>
</div>
<p><img alt="Basic Firmware Update" src="../images/push-pull.png" /></p>
</li>
<li>
<p>Click <strong>Schedule Update</strong> to trigger the Firmware Update process.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After doing so, a Firmware Update process will begin. Check the serial output logs - the <code>INFO [fw_update] [/anjay-pico-client/firmware_update/firmware_update.c]: Downloaded X bytes</code> logs should appear.</p>
<p><img alt="Firmware Update Logs" src="../images/fw_logs.PNG" /></p>
</div>
</li>
</ol>
<h2 id="download-upgrade-process">Download &amp; Upgrade Process<a class="headerlink" href="#download-upgrade-process" title="Permanent link">#</a></h2>
<p>If the Firmware Update is scheduled successfully, the device starts <strong>downloading</strong> the firmware at the next practical opportunity. The actual firmware <strong>update</strong> starts once the integrity and authenticity of the firmware image has been validated by the LwM2M Client.</p>
<p><img alt="Upgrading" src="../images/in-progress-basic.png" /></p>
<p>Once executed successfully, the status in the <strong>Update list</strong> panel changes to <code>Success</code>.</p>
<p><img alt="Successful update" src="../images/success.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the device is updating its firmware, it will deregister and reboot using the new firmware. This process may time several minutes.</p>
<p><img alt="Deregistered while upgrading" src="../images/deregistered.png" /></p>
</div>
<h3 id="monitoring-the-update-process">Monitoring the update process<a class="headerlink" href="#monitoring-the-update-process" title="Permanent link">#</a></h3>
<p>During the update process, the status of the firmware update can be monitored by reviewing the Resources <strong>State</strong> <code>/5/0/3</code> and <strong>Update Results</strong> <code>/5/0/5</code>.</p>
<p>To find the Resources, select the <strong>Data model</strong> tab and open the <strong>Firmware Update Object</strong> <code>/5</code>.</p>
<p><img alt="Firmware upgraded" src="../images/result1.png" /></p>
<p>If no errors occur, the update process follows this pattern:</p>
<ol>
<li><strong>Downloading</strong> <code>state 1</code> &amp; <code>update result 0</code></li>
<li><strong>Downloaded</strong> <code>state 2</code> &amp; <code>update result 0</code></li>
<li><strong>Updating</strong> <code>state 3</code> &amp; <code>update result 0</code></li>
<li><strong>Updated</strong> <code>state 0</code> &amp; <code>update result 1</code></li>
</ol>
<div class="admonition important">
<p class="admonition-title">Update successful?</p>
<p>Does the <strong>State</strong> <code>/5/0/3</code> report <code>0</code> and the <strong>Update Result</strong> <code>/5/0/5</code> report <code>1</code>? Congratulations! You've successfully updated the firmware of your device. 🎉</p>
</div>

<!-- Link to previous and/or next page -->

<nav
  class="md-navbottom__inner md-grid"
  aria-label="Footer"
>

  <!-- Link to previous page -->
  
    <a
      href="../module5/"
      class="md-navbottom__link md-navbottom__link--prev"
      rel="prev"
    >
      <div class="md-navbottom__button md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </div>
      <div class="md-navbottom__title">
        <div class="md-ellipsis">
          <span class="md-navbottom__direction">
            Previous
          </span>
          Theory Module 5
        </div>
      </div>
    </a>
  

  <!-- Link to next page -->
  
    <a
      href="../gradproject/"
      class="md-navbottom__link md-navbottom__link--next"
      rel="next"
    >
      <div class="md-navbottom__title">
        <div class="md-ellipsis">
          <span class="md-navbottom__direction">
            Next
          </span>
          Graduation Project
        </div>
      </div>
      <div class="md-navbottom__button md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
      </div>
    </a>
  
</nav>


<!-- Last update of source file -->


              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
  <footer class="md-footer">
    
      <div class="md-footer-nav">
        <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
          
            <a href="../module5/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
              <div class="md-footer-nav__button md-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
              </div>
              <div class="md-footer-nav__title">
                <div class="md-ellipsis">
                  <span class="md-footer-nav__direction">
                    Previous
                  </span>
                  Theory Module 5
                </div>
              </div>
            </a>
          
          
            <a href="../gradproject/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
              <div class="md-footer-nav__title">
                <div class="md-ellipsis">
                  <span class="md-footer-nav__direction">
                    Next
                  </span>
                  Graduation Project
                </div>
              </div>
              <div class="md-footer-nav__button md-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
              </div>
            </a>
          
        </nav>
      </div>
    
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid ">
        <div class="md-footer-copyright">
           &copy; Copyright 2022 <a href="https://www.avsystem.com/" target="_blank">AVSystem</a>
        </div>
        <div class="md-footer-meta__linksBox">
          <a class="md-footer-meta__link" href="https://www.avsystem.com/tags/dev-topics/" target="_blank">
              Our blog
          </a>
          <a class="md-footer-meta__link" href="https://iotdevzone.avsystem.com/" target="_blank">
              IoT Developer Zone
          </a>
          <a class="md-footer-meta__link" href="https://www.avsystem.com/products/coiote-iot-device-management-platform/" target="_blank">
              Coiote IoT DM Home
          </a>
          <a class="md-footer-meta__link" href="https://discord.avsystem.com/" target="_blank">
            Join our Discord
          </a>
        </div>
        
      </div>
    </div>
  </footer>
  
<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js-eu1.hs-scripts.com/139620700.js"></script>
<!-- End of HubSpot Embed Code -->

      
    </div>
    
      <script src="../../assets/javascripts/vendor.53cc9318.min.js"></script>
      <script src="../../assets/javascripts/bundle.e9c9f54f.min.js"></script><script id="__lang" type="application/json">{"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing"}</script>
      
    

      <script>
        app = initialize({
          base: "../..",
          features: ['navigation.tabs', 'content.code.annotate', 'content.code.copy'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../javascripts/extra.js"></script>
      
    
  </body>
</html>